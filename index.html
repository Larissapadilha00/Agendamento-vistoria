<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Agendamento de Vistorias</title>
<style>
    :root {
        --verde-principal: rgb(52, 69, 55);
        --verde-claro: rgb(72, 95, 75);
        --branco: #f5f5f5;
        --cinza: #e0e0e0;
        --vermelho: #e74c3c;
    }
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }
    body {
        background-color: var(--branco);
        font-family: Arial, sans-serif;
        color: var(--verde-principal);
        padding: 20px;
    }
    h1 {
        text-align: center;
        margin-bottom: 20px;
    }
    .card-container {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
    }
    .card {
        background-color: var(--verde-principal);
        color: var(--branco);
        padding: 20px;
        border-radius: 12px;
        cursor: pointer;
        width: 200px;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        transition: transform 0.3s;
    }
    .card:hover {
        transform: scale(1.05);
    }
    .hidden {
        display: none;
    }
    .selector, .back-button {
        margin-top: 20px;
        text-align: center;
    }
    .selector button, .back-button button {
        background-color: var(--verde-claro);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        margin: 5px;
    }
    .selector button:hover, .back-button button:hover {
        background-color: var(--verde-principal);
    }
    .week, .calendar {
        margin-top: 20px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
    }
    .week-grid {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 5px;
    }
    .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
    }
    .header-cell {
        font-weight: bold;
        text-align: center;
    }
    .day, .hour {
        background-color: var(--cinza);
        padding: 10px;
        border-radius: 8px;
        cursor: pointer;
        text-align: center;
    }
    .day:hover, .hour:hover {
        background-color: var(--verde-claro);
        color: white;
    }
    .selected {
        background-color: var(--verde-principal) !important;
        color: white;
    }
    .form {
        margin-top: 20px;
        display: none;
        flex-direction: column;
        gap: 10px;
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
        background-color: var(--cinza);
        padding: 20px;
        border-radius: 12px;
    }
    .form input {
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 6px;
    }
    .form button {
        background-color: var(--verde-principal);
        color: white;
        border: none;
        padding: 10px;
        border-radius: 8px;
        cursor: pointer;
    }
    .form button:hover {
        background-color: var(--verde-claro);
    }
    .no-available {
        color: var(--vermelho);
        text-align: center;
        margin-top: 10px;
    }
</style>
</head>
<body>

<h1>Agendamento de Vistorias</h1>

<div class="card-container" id="collaborators">
    <div class="card" onclick="selectCollaborator('Cleber')">Cleber</div>
    <div class="card" onclick="selectCollaborator('Devilson')">Devilson</div>
</div>

<div class="selector hidden" id="selector">
    <h2 id="selectedCollaborator"></h2>
    <button onclick="showWeek()">Semana</button>
    <button onclick="showMonth()">MÃªs</button>
</div>

<div class="back-button hidden" id="backButton">
    <button onclick="goBack()">â¬… Voltar</button>
</div>

<div class="week hidden" id="week"></div>
<div class="calendar hidden" id="calendar"></div>

<div class="form" id="form">
    <input type="text" id="nome" placeholder="Nome do responsÃ¡vel">
    <input type="text" id="empreendimento" placeholder="Empreendimento">
    <input type="text" id="local" placeholder="Local (Ex: Ap 101)">
    <button onclick="book()">Agendar</button>
</div>

<script>
    const horarios = ["08:00", "09:00", "10:00", "11:00", "13:00", "14:00", "15:00"];
    let selectedCollaborator = '';
    let selectedDate = '';
    let selectedHour = '';
    const agendamentos = {};

    function selectCollaborator(nome) {
        selectedCollaborator = nome;
        document.getElementById('collaborators').classList.add('hidden');
        document.getElementById('selector').classList.remove('hidden');
        document.getElementById('selectedCollaborator').innerText = `Agendamento - ${nome}`;
    }

    function showWeek() {
        clearScreens();
        const week = document.getElementById('week');
        week.innerHTML = '';
        week.classList.remove('hidden');
        document.getElementById('backButton').classList.remove('hidden');

        const today = new Date();
        const start = new Date(today.setDate(today.getDate() - today.getDay() + 1));

        const grid = document.createElement('div');
        grid.className = 'week-grid';
        grid.style.gridTemplateRows = `auto repeat(${horarios.length}, auto)`;

        grid.innerHTML += `<div class="header-cell"></div>`;
        for (let i = 0; i < 5; i++) {
            const d = new Date(start);
            d.setDate(start.getDate() + i);
            const label = `<div class="header-cell">${d.getDate()}/${d.getMonth()+1} (${['Seg','Ter','Qua','Qui','Sex'][i]})</div>`;
            grid.innerHTML += label;
        }

        for (const hora of horarios) {
            grid.innerHTML += `<div class="header-cell">${hora}</div>`;
            for (let i = 0; i < 5; i++) {
                const d = new Date(start);
                d.setDate(start.getDate() + i);
                const dateStr = `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;

                const key = `${selectedCollaborator}-${dateStr}-${hora}`;
                if (agendamentos[key]) {
                    grid.innerHTML += `<div class="hour" style="visibility:hidden"></div>`;
                } else {
                    grid.innerHTML += `<div class="hour" onclick="selectHour('${dateStr}','${hora}')">${hora}</div>`;
                }
            }
        }

        week.appendChild(grid);
    }

    function showMonth() {
        clearScreens();
        const calendar = document.getElementById('calendar');
        calendar.innerHTML = '';
        calendar.classList.remove('hidden');
        document.getElementById('backButton').classList.remove('hidden');

        const today = new Date();
        const year = today.getFullYear();
        const month = today.getMonth();
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        const grid = document.createElement('div');
        grid.className = 'calendar-grid';

        const weekDays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab'];
        for (const day of weekDays) {
            grid.innerHTML += `<div class="header-cell">${day}</div>`;
        }

        for (let i = 0; i < firstDay; i++) {
            grid.innerHTML += `<div></div>`;
        }

        for (let d = 1; d <= daysInMonth; d++) {
            const dateStr = `${year}-${month+1}-${d}`;
            grid.innerHTML += `<div class="day" onclick="openDay('${dateStr}', this)">${d}</div>`;
        }

        calendar.appendChild(grid);
    }

    function openDay(dateStr, btn) {
        const existing = document.getElementById('hours-' + dateStr);
        if (existing) {
            existing.remove();
            btn.classList.remove('selected');
            return;
        }

        const row = document.createElement('div');
        row.className = 'day-row';
        row.id = 'hours-' + dateStr;

        let available = false;
        for (const hora of horarios) {
            const key = `${selectedCollaborator}-${dateStr}-${hora}`;
            if (!agendamentos[key]) {
                available = true;
                const hourBtn = document.createElement('div');
                hourBtn.className = 'hour';
                hourBtn.innerText = hora;
                hourBtn.onclick = () => selectHour(dateStr, hora);
                row.appendChild(hourBtn);
            }
        }

        if (!available) {
            const noAvailable = document.createElement('div');
            noAvailable.className = 'no-available';
            noAvailable.innerText = 'ðŸ”´ Sem horÃ¡rio disponÃ­vel';
            row.appendChild(noAvailable);
        }

        btn.classList.add('selected');
        btn.parentNode.after(row);
    }

    function selectHour(date, hour) {
        selectedDate = date;
        selectedHour = hour;
        document.getElementById('form').style.display = 'flex';
    }

    function book() {
        const nome = document.getElementById('nome').value.trim();
        const empreendimento = document.getElementById('empreendimento').value.trim();
        const local = document.getElementById('local').value.trim();

        if (!nome || !empreendimento || !local) {
            alert('Preencha todos os campos!');
            return;
        }

        const key = `${selectedCollaborator}-${selectedDate}-${selectedHour}`;
        agendamentos[key] = { nome, empreendimento, local };

        alert('Agendado com sucesso!');
        document.getElementById('form').style.display = 'none';
        document.getElementById('nome').value = '';
        document.getElementById('empreendimento').value = '';
        document.getElementById('local').value = '';
        showWeek();
        showMonth();
    }

    function goBack() {
        clearScreens();
        document.getElementById('selector').classList.remove('hidden');
        document.getElementById('backButton').classList.add('hidden');
    }

    function clearScreens() {
        document.getElementById('week').classList.add('hidden');
        document.getElementById('calendar').classList.add('hidden');
        document.getElementById('form').style.display = 'none';

        const opened = document.querySelectorAll('.day-row');
        opened.forEach(el => el.remove());
        const days = document.querySelectorAll('.day');
        days.forEach(el => el.classList.remove('selected'));
    }
</script>

</body>
</html>
